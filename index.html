<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>4x4 Grid Permutation Generator</title>
<style>
  body {
    background: #f0f0f0;
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  h1 {
    text-align: center;
  }
  table {
    margin: 20px auto;
    border-collapse: collapse;
  }
  td {
    border: 1px solid #999;
    padding: 8px;
  }
  input[type="number"] {
    width: 50px;
    font-size: 16px;
    text-align: center;
  }
  #buttons {
    text-align: center;
    margin-bottom: 20px;
  }
  button {
    background: #333;
    color: #fff;
    border: none;
    padding: 10px 16px;
    margin: 0 8px;
    cursor: pointer;
    border-radius: 4px;
  }
  button:hover {
    background: #555;
  }
  #results {
    max-width: 900px;
    margin: 0 auto;
    background: #fff;
    border: 1px solid #ccc;
    padding: 10px;
    white-space: pre-wrap;
    font-family: monospace;
    overflow-x: auto;
    height: 500px;
    overflow-y: auto;
  }
  h2 {
    margin-top: 30px;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Fill the 4x4 Grid Generator</h1>

<!-- 4x4 Input Grid -->
<table id="gridTable">
  <tbody>
    <!-- JS will populate -->
  </tbody>
</table>

<div id="buttons">
  <button id="generateBtn">Generate Combinations</button>
</div>

<h2>Permutation Results</h2>
<div id="results"></div>

<script>
  // Generate 4x4 input grid with restrictions
  const tbody = document.querySelector('#gridTable tbody');
  for (let r=0; r<4; r++) {
    const tr = document.createElement('tr');
    for (let c=0; c<4; c++) {
      const td = document.createElement('td');
      const input = document.createElement('input');
      input.type = 'text'; // Use text to better control input
      input.maxLength = 1; // Only 1 character
      input.pattern = '[0-9]'; // Only digits
      input.placeholder = '0-9';
      input.id = `cell-${r}-${c}`;
      // Restrict input to digits 0-9
      input.addEventListener('input', () => {
        input.value = input.value.replace(/[^0-9]/g, ''); // Remove non-digits
      });
      td.appendChild(input);
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  }

  document.getElementById('generateBtn').addEventListener('click', () => {
    // Collect digits
    const digits = [];
    for (let r=0; r<4; r++) {
      for (let c=0; c<4; c++) {
        const val = document.getElementById(`cell-${r}-${c}`).value.trim();
        if (val === '' || isNaN(val) || val < 0 || val > 9 || val.length !== 1) {
          alert('Please fill all cells with digits 0-9.');
          return;
        }
        digits.push(val);
      }
    }

    // Generate unique permutations using counting method
    const counts = {};
    digits.forEach(d => { counts[d] = (counts[d] || 0) + 1; });

    const uniquePerms = new Set();

    const permuteUnique = (path, remainingCounts) => {
      if (path.length === 16) {
        uniquePerms.add(path.join(''));
        return;
      }
      for (let digit in remainingCounts) {
        if (remainingCounts[digit] > 0) {
          remainingCounts[digit]--;
          permuteUnique([...path, digit], remainingCounts);
          remainingCounts[digit]++;
        }
      }
    };

    permuteUnique([], {...counts});

    // Convert set to array
    const permsArray = Array.from(uniquePerms);

    // Display
    displayPermutations(permsArray);
  });

  function displayPermutations(perms) {
    const container = document.getElementById('results');
    let html = '';

    html += `Total unique permutations: ${perms.length}\n\n`;

    // List all permutations
    perms.forEach((p, index) => {
      html += `${index + 1}. ${p}\n`;
    });

    container.textContent = html;
  }
</script>

</body>
</html>
