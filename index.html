<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>4x4 Grid Permutation Generator</title>
<style>
  body {
    background: #f0f0f0;
    font-family: Arial, sans-serif;
    padding: 20px;
  }

  h1 {
    text-align: center;
    margin-bottom: 10px;
  }

  /* Larger, clearer 4x4 grid style */
  table {
    margin: 0 auto 20px auto;
    border-collapse: collapse;
    width: fit-content;
  }

  td {
    border: 2px solid #999;
    padding: 15px;
  }

  input[type="text"] {
    width: 60px;
    height: 60px;
    font-size: 24px;
    text-align: center;
    border: 2px solid #666;
    border-radius: 4px;
  }

  #generateBtn {
    display: block;
    margin: 0 auto 20px auto;
    background-color: #555;
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 16px;
    border-radius: 6px;
    cursor: pointer;
  }

  #generateBtn:hover {
    background-color: #777;
  }

  h2 {
    text-align: center;
    margin-top: 30px;
  }

  #results {
    max-width: 1000px;
    margin: 10px auto;
    background: #fff;
    border: 1px solid #ccc;
    padding: 10px;
    font-family: monospace;
    height: 500px;
    overflow-y: auto;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<h1 style="text-align:center;">Fill the 4x4 Grid and Generate Permutations</h1>

<!-- 4x4 Input Grid -->
<table id="gridTable"></table>

<!-- Generate Button -->
<button id="generateBtn">Generate Combinations</button>

<h2 style="text-align:center;">Permutation Results</h2>
<div id="results"></div>

<script>
  // Generate a large, clear 4x4 grid
  const tbody = document.querySelector('#gridTable');

  for (let r=0; r<4; r++) {
    const row = document.createElement('tr');
    for (let c=0; c<4; c++) {
      const cell = document.createElement('td');
      const input = document.createElement('input');
      input.type = 'text';
      input.maxLength = 1; // only one character
      input.pattern = '[0-9]'; // only digits
      input.placeholder = '0-9';
      input.id = `cell-${r}-${c}`;

      // Restrict input to digits 0-9
      input.addEventListener('input', () => {
        input.value = input.value.replace(/[^0-9]/g, '');
      });

      cell.appendChild(input);
      row.appendChild(cell);
    }
    tbody.appendChild(row);
  }

  document.getElementById('generateBtn').addEventListener('click', () => {
    // Collect digits from the grid
    const digits = [];
    for (let r=0; r<4; r++) {
      for (let c=0; c<4; c++) {
        const val = document.getElementById(`cell-${r}-${c}`).value.trim();
        if (val === '' || isNaN(val) || val < 0 || val > 9 || val.length !== 1) {
          alert('Please fill all cells with digits 0-9.');
          return;
        }
        digits.push(val);
      }
    }

    // Count occurrences of each digit
    const counts = {};
    digits.forEach(d => { counts[d] = (counts[d] || 0) + 1; });

    const uniquePerms = new Set();

    // Recursive function for unique permutations
    const permuteUnique = (path, remainingCounts) => {
      if (path.length === 16) {
        uniquePerms.add(path.join(''));
        return;
      }
      for (let digit in remainingCounts) {
        if (remainingCounts[digit] > 0) {
          remainingCounts[digit]--;
          permuteUnique([...path, digit], remainingCounts);
          remainingCounts[digit]++;
        }
      }
    };

    permuteUnique([], {...counts});

    // Convert set to array
    const permsArray = Array.from(uniquePerms);

    // Display the results
    const container = document.getElementById('results');
    let html = '';
    html += `Total unique permutations: ${permsArray.length}\n\n`;
    permsArray.forEach((p, index) => {
      html += `${index + 1}. ${p}\n`;
    });
    container.textContent = html;
  });
</script>

</body>
</html>
